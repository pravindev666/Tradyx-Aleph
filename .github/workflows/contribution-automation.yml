# ⚠️ CONTRIBUTION AUTOMATION WORKFLOW
# This workflow is OPTIONAL and can be safely deleted if not needed.
# It makes automated commits to show activity on your GitHub contribution graph.
# 
# TO USE: Uncomment the schedule triggers below and set your GitHub email.
# TO DELETE: Just delete this file - it won't affect the main project.

name: Automated Contributions

on:
  # ⏰ SCHEDULE: Uncomment one of the options below
  # Option 1: Daily commit at noon UTC
  schedule:
    - cron: '0 12 * * *'  # Runs daily at 12:00 PM UTC
  
  # Option 2: Multiple commits per day (uncomment if you want more activity)
  # schedule:
  #   - cron: '0 0 * * *'   # Midnight UTC
  #   - cron: '0 12 * * *'  # Noon UTC
  #   - cron: '0 18 * * *'  # 6 PM UTC
  
  # Option 3: Every few hours (uncomment for frequent commits)
  # schedule:
  #   - cron: '0 */6 * * *'  # Every 6 hours
  
  # Manual trigger (for testing)
  workflow_dispatch:

jobs:
  contribute:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    
    permissions:
      contents: write  # Required to push commits
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
      
      - name: Update contribution log
        run: |
          # Create or update the contribution log file
          CONTRIB_FILE="contributions-log.txt"
          
          # Get current timestamp
          TIMESTAMP=$(date -u +"%Y-%m-%d %H:%M:%S UTC")
          
          # Append timestamp to log file
          echo "[$TIMESTAMP] Automated contribution" >> "$CONTRIB_FILE"
          
          # Keep only last 1000 lines to prevent file from getting too large
          tail -n 1000 "$CONTRIB_FILE" > "$CONTRIB_FILE.tmp" && mv "$CONTRIB_FILE.tmp" "$CONTRIB_FILE"
      
      - name: Commit and push
        run: |
          # ⚠️ IMPORTANT: Replace with your GitHub email address
          # You can find it in GitHub Settings > Emails
          # Make sure this email is verified on your GitHub account
          GIT_EMAIL="${GITHUB_ACTOR}@users.noreply.github.com"
          
          # Alternative: Use your actual GitHub email (uncomment and replace)
          # GIT_EMAIL="your-email@example.com"
          
          git config --local user.email "$GIT_EMAIL"
          git config --local user.name "$GITHUB_ACTOR"
          
          # Add the contribution log file
          git add contributions-log.txt
          
          # Check if there are changes
          if git diff --staged --quiet; then
            echo "ℹ️  No changes to commit (file already up to date)"
          else
            # Create commit with timestamp
            COMMIT_MSG="chore: automated contribution [$(date -u +%Y-%m-%d)]"
            git commit -m "$COMMIT_MSG"
            
            # Push to repository
            git push origin HEAD:${{ github.ref_name }}
            echo "✅ Automated contribution committed and pushed"
          fi
        continue-on-error: true

